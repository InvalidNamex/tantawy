{% extends 'base.html' %}
{% load static %}

{% block title %}لوحة التحكم - نظام إدارة الطنطاوي{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
    <ol class="glass-breadcrumb breadcrumb">
        <li class="glass-breadcrumb-item breadcrumb-item active">
            <i class="bi bi-house"></i> الرئيسية
        </li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<!-- Welcome Section with Glass Effect -->
<div class="row">
    <div class="col-12">
        <div class="hero-section glass-card-primary mb-4">
            <div class="row align-items-center flex-column-reverse flex-md-row">
                <div class="col-12 col-md-8 text-center text-md-start">
                    <h1 class="hero-title text-white mb-2">
                        <i class="bi bi-house-door me-2 d-none d-sm-inline"></i>
                        مرحباً، {{ user.get_full_name|default:user.username }}!
                    </h1>
                    <p class="hero-subtitle text-white mb-3 d-none d-md-block">
                        لوحة تحكم نظام إدارة الطنطاوي - مركزك الرئيسي لإدارة المخزون والمتاجر
                    </p>
                    <div class="d-flex align-items-center justify-content-center justify-content-md-start text-white flex-wrap">
                        <i class="bi bi-calendar me-2"></i>
                        <span class="small">آخر تسجيل دخول: 
                            {% if user.last_login %}
                                {{ user.last_login|date:"j F Y - H:i" }}
                            {% else %}
                                أول مرة
                            {% endif %}
                        </span>
                    </div>
                </div>
                <div class="col-12 col-md-4 text-center mb-3 mb-md-0">
                    <img src="/media/logo.png" alt="شعار الطنطاوي" class="img-fluid d-none d-sm-inline-block" style="max-height: 80px; filter: brightness(0) invert(1);">
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Quick Stats Cards with Glass Effects -->
<div class="dashboard-stats">
    {% if card_visibility.items_groups %}
    <div class="glass-dashboard-card glass-slide-up">
        <div class="card-icon">
            <i class="bi bi-collection"></i>
        </div>
        <h5 class="card-title">مجموعات الأصناف</h5>
        <div class="card-value">{{ items_groups_count }}</div>
        <p class="card-subtitle">إجمالي المجموعات المسجلة</p>
        <a href="{% url 'core:itemsgroups' %}" class="glass-btn-primary glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.items %}
    <div class="glass-dashboard-card glass-slide-up" style="animation-delay: 0.1s;">
        <div class="card-icon">
            <i class="bi bi-box"></i>
        </div>
        <h5 class="card-title">الأصناف</h5>
        <div class="card-value">{{ items_count }}</div>
        <p class="card-subtitle">إجمالي الأصناف المتاحة</p>
        <a href="{% url 'core:items' %}" class="glass-btn-success glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.customers %}
    <div class="glass-dashboard-card glass-slide-up" style="animation-delay: 0.2s;">
        <div class="card-icon">
            <i class="bi bi-person-check"></i>
        </div>
        <h5 class="card-title">العملاء</h5>
        <div class="card-value">{{ customers_count }}</div>
        <p class="card-subtitle">عدد العملاء المسجلين</p>
        <a href="{% url 'core:customers' %}" class="glass-btn-info glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.vendors %}
    <div class="glass-dashboard-card glass-slide-up" style="animation-delay: 0.3s;">
        <div class="card-icon">
            <i class="bi bi-truck"></i>
        </div>
        <h5 class="card-title">الموردين</h5>
        <div class="card-value">{{ vendors_count }}</div>
        <p class="card-subtitle">عدد الموردين النشطين</p>
        <a href="{% url 'core:vendors' %}" class="glass-btn-warning glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
</div>

<!-- Additional Stats Row with Glass Effects -->
<div class="dashboard-stats">
    {% if card_visibility.price_lists %}
    <div class="glass-dashboard-card glass-scale-in" style="animation-delay: 0.4s;">
        <div class="card-icon">
            <i class="bi bi-currency-dollar"></i>
        </div>
        <h5 class="card-title">قوائم الأسعار</h5>
        <div class="card-value">{{ price_lists_count }}</div>
        <p class="card-subtitle">قوائم الأسعار المتاحة</p>
        <a href="{% url 'core:pricelists' %}" class="glass-btn-info glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.store_groups %}
    <div class="glass-dashboard-card glass-scale-in" style="animation-delay: 0.5s;">
        <div class="card-icon">
            <i class="bi bi-building"></i>
        </div>
        <h5 class="card-title">مجموعات المخازن</h5>
        <div class="card-value">{{ store_groups_count }}</div>
        <p class="card-subtitle">مجموعات المخازن النشطة</p>
        <a href="{% url 'core:storegroups' %}" class="glass-btn-success glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.stores %}
    <div class="glass-dashboard-card glass-scale-in" style="animation-delay: 0.6s;">
        <div class="card-icon">
            <i class="bi bi-shop"></i>
        </div>
        <h5 class="card-title">المخازن</h5>
        <div class="card-value">{{ stores_count }}</div>
        <p class="card-subtitle">عدد المخازن النشطة</p>
        <a href="{% url 'core:stores' %}" class="glass-btn-warning glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.invoices %}
    <div class="glass-dashboard-card glass-scale-in" style="animation-delay: 0.7s;">
        <div class="card-icon">
            <i class="bi bi-receipt"></i>
        </div>
        <h5 class="card-title">إجمالي الفواتير</h5>
        <div class="card-value">{{ total_invoices_count }}</div>
        <p class="card-subtitle">جميع الفواتير المسجلة</p>
        <a href="{% url 'core:invoices_main' %}" class="glass-btn-primary glass-btn mt-3">
            <i class="bi bi-eye me-1"></i> عرض الكل
        </a>
    </div>
    {% endif %}
</div>

<!-- Management Tools Row with Glass Effects -->
<div class="dashboard-stats">
    {% if card_visibility.agents_manage %}
    <div class="glass-dashboard-card glass-slide-up" style="animation-delay: 0.8s;">
        <div class="card-icon">
            <i class="bi bi-people"></i>
        </div>
        <h5 class="card-title">إدارة المناديب</h5>
        <div class="card-value"><i class="bi bi-arrow-right-circle"></i></div>
        <p class="card-subtitle">إدارة المناديب والمتابعة</p>
        <a href="{% url 'authentication:agents_manage' %}" class="glass-btn-primary glass-btn mt-3">
            <i class="bi bi-arrow-right me-1"></i> إدارة
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.visit_plans %}
    <div class="glass-dashboard-card glass-slide-up" style="animation-delay: 0.9s;">
        <div class="card-icon">
            <i class="bi bi-calendar-check"></i>
        </div>
        <h5 class="card-title">خطط الزيارات</h5>
        <div class="card-value"><i class="bi bi-arrow-right-circle"></i></div>
        <p class="card-subtitle">إدارة خطط الزيارات الميدانية</p>
        <a href="{% url 'core:visitplans_manage' %}" class="glass-btn-success glass-btn mt-3">
            <i class="bi bi-arrow-right me-1"></i> إدارة
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.inventory %}
    <div class="glass-dashboard-card glass-slide-up" style="animation-delay: 1.0s;">
        <div class="card-icon">
            <i class="bi bi-boxes"></i>
        </div>
        <h5 class="card-title">إدارة المخزون</h5>
        <div class="card-value"><i class="bi bi-arrow-right-circle"></i></div>
        <p class="card-subtitle">إدارة الكميات والمخزون</p>
        <a href="{% url 'core:inventory_management' %}" class="glass-btn-info glass-btn mt-3">
            <i class="bi bi-arrow-right me-1"></i> إدارة
        </a>
    </div>
    {% endif %}
    
    {% if card_visibility.users_manage %}
    <div class="glass-dashboard-card glass-slide-up" style="animation-delay: 1.1s;">
        <div class="card-icon">
            <i class="bi bi-people"></i>
        </div>
        <h5 class="card-title">إدارة المستخدمين</h5>
        <div class="card-value"><i class="bi bi-arrow-right-circle"></i></div>
        <p class="card-subtitle">إدارة حسابات المستخدمين</p>
        <a href="{% url 'authentication:users_list' %}" class="glass-btn-warning glass-btn mt-3">
            <i class="bi bi-arrow-right me-1"></i> إدارة
        </a>
    </div>
    {% endif %}
</div>


{% endblock %}